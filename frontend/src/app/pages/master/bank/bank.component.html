<nb-card>
  <nb-card-header class="d-flex justify-content-between align-items-center flex-wrap">
    <h4 class="title">Master Bank</h4>
    <div class="d-flex gap-2">
      <button nbButton status="warning" (click)="loadBanks()" [disabled]="isRefreshing">
        <nb-icon *ngIf="!isRefreshing" icon="refresh-outline"></nb-icon>
        <nb-spinner *ngIf="isRefreshing" size="tiny"></nb-spinner>
      </button>
      <button nbButton status="primary" (click)="openFormDialog()">
        <nb-icon icon="plus-outline"></nb-icon>
        Tambah Bank
      </button>
    </div>
  </nb-card-header>

  <nb-card-body>
    <nb-form-field class="mb-3">
      <nb-icon nbPrefix icon="search-outline"></nb-icon>
      <input nbInput placeholder="Cari bank..." [(ngModel)]="searchTerm" />
    </nb-form-field>

    <div class="table-responsive">
      <table class="table table-hover table-bordered table-sm">
        <thead>
          <tr>
            <th>#</th>
            <th>Kode Bank</th>
            <th>Nama Bank</th>
            <th>No Rekening</th>
            <th>Atas Nama</th>
            <th>Cara Bayar</th>
            <th>Aksi</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let bank of getFilteredBanks(); let i = index">
            <td>{{ i + 1 }}</td>
            <td>{{ bank.kode_bank }}</td>
            <td>{{ bank.nama_bank }}</td>
            <td>{{ bank.no_rekening || '-' }}</td>
            <td>{{ bank.atas_nama || '-' }}</td>
            <td>
              <ul>
                <li *ngFor="let cb of bank.cara_bayar">{{ cb.nama_cara_bayar }}</li>
              </ul>
            </td>
            <td>
              <div class="btn-group">
                <button nbButton ghost status="info" (click)="openFormDialog(bank)">
                  <nb-icon icon="edit-2-outline"></nb-icon>
                </button>
                <button nbButton ghost status="danger" (click)="deleteBank(bank.id)">
                  <nb-icon icon="trash-2-outline"></nb-icon>
                </button>
              </div>
            </td>
          </tr>
          <tr *ngIf="banks.length === 0">
            <td colspan="7" class="text-center text-muted">Tidak ada data</td>
          </tr>
        </tbody>
      </table>
    </div>
  </nb-card-body>
</nb-card>
