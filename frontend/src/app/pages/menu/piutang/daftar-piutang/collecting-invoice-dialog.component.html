<nb-card>
  <nb-card-header>Collecting Invoice</nb-card-header>
  <nb-card-body>
    <input nbInput placeholder="Cari nama pelanggan..." [(ngModel)]="searchTerm" (input)="applyFilter()" />

    <table class="table table-striped table-bordered" style="margin-top: 1rem;">
      <thead>
        <tr>
          <th>
            <input type="checkbox" [checked]="areAllSelected()" (change)="toggleSelectAll($event.target.checked)" />
          </th>
          <th>Tanggal Invoice</th>
          <th>No Invoice</th>
          <th>Nama Pelanggan</th>
          <th>Total Tagihan</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let invoice of filteredInvoices">
          <td>
            <input type="checkbox" [checked]="selectedInvoiceIds.includes(invoice.id)"
              (change)="toggleInvoiceSelection(invoice.id, $event.target.checked)" />
          </td>
          <td>{{ invoice.tanggal | date:'dd MMM yyyy' }}</td>
          <td>{{ invoice.nomor_invoice }}</td>
          <td>{{ invoice.nama_pelanggan }}</td>
          <td>{{ invoice.total | currency:'IDR' }}</td>
        </tr>
        <tr *ngIf="filteredInvoices.length === 0">
          <td colspan="5" class="text-center">Tidak ada data invoice.</td>
        </tr>
      </tbody>
    </table>
  </nb-card-body>
  <nb-card-footer style="display:flex; justify-content:flex-end; gap: 0.5rem;">
    <button nbButton status="basic" (click)="close()">Batal</button>
    <button nbButton status="primary" [disabled]="selectedInvoiceIds.length === 0" (click)="save()">Simpan</button>
  </nb-card-footer>
</nb-card>
