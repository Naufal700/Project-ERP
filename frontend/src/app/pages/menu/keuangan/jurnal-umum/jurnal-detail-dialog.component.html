<nb-card class="jurnal-detail-modal">
  <nb-card-header class="d-flex justify-content-between align-items-center header">
    <div>
      <h5 class="mb-0">Detail Jurnal</h5>
      <div class="d-flex align-items-center mt-1">
        <span class="no-jurnal">● {{ jurnal.kode_jurnal }}</span>
        <span class="tanggal ms-4">Tanggal: {{ jurnal.tanggal | date: 'dd/MM/yyyy' }}</span>
        <span class="deskripsi ms-4">Deskripsi: {{ jurnal.keterangan || 'Manual Jurnal' }}</span>
      </div>
    </div>
    <button nbButton size="small" status="basic" (click)="close()">✖</button>
  </nb-card-header>

  <nb-card-body>
    <!-- Export -->
    <div class="d-flex justify-content-between align-items-center mb-3">
      <button nbButton status="success" size="small" (click)="exportExcel()">
        <nb-icon icon="download-outline"></nb-icon> Export To Excel
      </button>

      <nb-form-field class="search-box">
        <nb-icon nbPrefix icon="search-outline"></nb-icon>
        <input nbInput placeholder="Cari keterangan, nama akun, atau kode akun..." [(ngModel)]="searchTerm"
          (ngModelChange)="filterDetails()" />
      </nb-form-field>
    </div>

    <!-- Table -->
    <div class="table-responsive jurnal-table">
      <table class="table table-bordered table-hover table-striped">
        <thead>
          <tr>
            <th style="width: 50px;">No</th>
            <th style="width: 150px;">Kode Akun</th>
            <th>Nama Akun</th>
            <th>Keterangan</th>
            <th class="text-end" style="width: 150px;">Debit</th>
            <th class="text-end" style="width: 150px;">Kredit</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let d of paginatedDetails; let i = index">
            <td>{{ (currentPage - 1) * perPage + i + 1 }}</td>
            <td>{{ d.kode_akun }}</td>
            <td>{{ d.nama_akun }}</td>
            <td>
              {{ d.keterangan && d.keterangan.trim() !== '' ? d.keterangan : 'Jurnal Manual' }}
            </td>
            <td class="text-end">{{ d.jenis === 'debit' ? (d.nominal | number:'1.0-0') : '-' }}</td>
            <td class="text-end">{{ d.jenis === 'kredit' ? (d.nominal | number:'1.0-0') : '-' }}</td>
          </tr>
          <tr *ngIf="paginatedDetails.length === 0">
            <td colspan="6" class="text-center text-muted">Tidak ada data</td>
          </tr>
        </tbody>

      </table>
    </div>
    <!-- Pagination -->
    <div class="d-flex justify-content-between align-items-center mt-2">
      <div class="text-muted">
        Terdapat {{ filteredDetails.length }} data.
      </div>
      <div class="d-flex align-items-center gap-2">
        <button nbButton size="tiny" status="basic" (click)="changePage(currentPage - 1)"
          [disabled]="currentPage === 1">
          ‹
        </button>
        <span>Halaman {{ currentPage }} dari {{ totalPages }}</span>
        <button nbButton size="tiny" status="basic" (click)="changePage(currentPage + 1)"
          [disabled]="currentPage === totalPages">
          ›
        </button>
      </div>
    </div>

    <!-- Total Debit Kredit -->
    <div class="total-section d-flex justify-content-between mt-3">
      <div class="total debit">
        <span class="label">TOTAL DEBIT</span>
        <span class="value">Rp. {{ getTotal('debit') | number:'1.0-0' }}</span>
      </div>
      <div class="total kredit">
        <span class="label">TOTAL KREDIT</span>
        <span class="value">Rp. {{ getTotal('kredit') | number:'1.0-0' }}</span>
      </div>
    </div>
  </nb-card-body>
</nb-card>
