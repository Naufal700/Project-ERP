<nb-card class="invoice-card">
  <nb-card-header class="d-flex justify-content-between align-items-center header">
    <h5 class="title">Detail Faktur: {{ invoice?.nomor_invoice }}</h5>
    <button nbButton ghost status="basic" size="small" (click)="close()">
      <nb-icon icon="close-outline"></nb-icon>
    </button>
  </nb-card-header>

  <nb-card-body class="body">
    <!-- Informasi Faktur -->
    <div class="invoice-info d-flex justify-content-between flex-wrap mb-3">
      <div>
        <p><strong>Pelanggan:</strong> {{ invoice?.pelanggan?.nama_pelanggan }}</p>
        <p><strong>Tanggal:</strong> {{ invoice?.tanggal | date:'dd/MM/yyyy' }}</p>
      </div>
      <div class="invoice-meta">
        <p><strong>Status:</strong>
          <span [ngClass]="{
            'text-muted': invoice?.status === 'draft',
            'text-success': invoice?.status === 'approved'
          }">
            {{ invoice?.status | titlecase }}
          </span>
        </p>
      </div>
    </div>

    <!-- Tabel Detail Produk -->
    <div class="table-responsive mt-2">
      <table class="table table-bordered table-sm align-middle">
        <thead>
          <tr>
            <th>#</th>
            <th>Produk</th>
            <th class="text-end">Qty</th>
            <th class="text-end">Harga</th>
            <th class="text-end">Diskon</th>
            <th class="text-end">PPN</th>
            <th class="text-end">Subtotal</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of invoice?.details; let i = index">
            <td>{{ i + 1 }}</td>
            <td>{{ item.produk?.nama_produk }}</td>
            <td class="text-end">{{ item.qty }}</td>
            <td class="text-end">{{ item.harga | currency:'IDR':'symbol':'1.0-0' }}</td>
            <td class="text-end text-danger">-{{ item.diskon | currency:'IDR':'symbol':'1.0-0' }}</td>
            <td class="text-end">{{ item.ppn | currency:'IDR':'symbol':'1.0-0' }}</td>
            <td class="text-end fw-bold">{{ item.subtotal | currency:'IDR':'symbol':'1.0-0' }}</td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Ringkasan Total -->
    <div class="summary mt-4 text-end">
      <div class="summary-item">
        <span>Bruto:</span>
        <strong>{{ invoice?.bruto | currency:'IDR':'symbol':'1.0-0' }}</strong>
      </div>
      <div class="summary-item text-danger">
        <span>Diskon:</span>
        <strong>-{{ invoice?.diskon | currency:'IDR':'symbol':'1.0-0' }}</strong>
      </div>
      <div class="summary-item">
        <span>PPN:</span>
        <strong>{{ invoice?.ppn | currency:'IDR':'symbol':'1.0-0' }}</strong>
      </div>
      <div class="summary-item total">
        <span>Total Netto:</span>
        <strong>{{ invoice?.total | currency:'IDR':'symbol':'1.0-0' }}</strong>
      </div>
    </div>
  </nb-card-body>
</nb-card>
